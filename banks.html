<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Banks — Income & Expense</title>
<style>
  :root{
    --bg:#071024;--card:#07182a;--muted:#9aa4b2;--accent:#7dd3fc;
  }
  body {
    font-family: Inter, Arial;
    background: var(--bg);
    color: #e6eef6;
    margin: 18px;
  }
  .card {
    background: var(--card);
    padding: 14px;
    border-radius: 10px;
    margin-bottom: 12px;
  }
  label { display:block;margin-top:6px }
  input, select {
    padding: 8px;
    border-radius: 6px;
    border: 1px solid rgba(247,239,239,0.04);
    background: #1d1f22;
    color: inherit;
    width: 100%;
    box-sizing: border-box;
  }
  ::placeholder { color:#bfc8d6;opacity:1 }
  button {
    padding:8px 10px;border-radius:8px;border:none;cursor:pointer;
    background:var(--accent);color:#000;font-weight:600;
  }
  button:hover{opacity:0.85}
  nav a{color:var(--muted);text-decoration:none;margin:0 6px;font-size:14px;}
  nav a:hover{color:var(--accent)}
  header h2{
    font-weight:600;
    background:linear-gradient(90deg,var(--accent),#7dd3fc);
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    margin:0;
  }
</style>
</head>
<body>
  <header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
    <h2>Bank Accounts</h2>
    <nav>
      <a href="index.html">Dashboard</a> |
      <a href="banks.html">Banks</a> |
      <a href="transactions.html">Transactions</a>
    </nav>
  </header>

  <div class="card">
    <strong>Manage Banks</strong>
    <div style="margin-top:8px;display:flex;gap:8px">
      <input id="newBankName" placeholder="New bank name" />
      <input id="newBankOpening" placeholder="Opening balance (₹)" type="number" />
      <button id="addBankBtn">Add</button>
    </div>
    <div style="margin-top:8px" id="banksArea"></div>
  </div>

  <div class="card">
    <strong>Intra-bank Transfer</strong>
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:8px">
      <div>
        <label>From</label>
        <select id="transferFrom"></select>
      </div>
      <div>
        <label>To</label>
        <select id="transferTo"></select>
      </div>
      <div>
        <label>Amount (₹)</label>
        <input id="transferAmt" type="number" step="0.01" />
      </div>
    </div>
    <div style="margin-top:8px;display:flex;gap:8px">
      <input id="transferDate" type="date" />
      <input id="transferNotes" placeholder="Optional note" />
      <button id="doTransfer">Transfer</button>
    </div>
  </div>

  <footer style="margin-top:20px;text-align:center;color:var(--muted);font-size:13px;opacity:0.8;">
    © 2025 Subair V M — Created with ❤️ Income & Expense Dashboard
  </footer>

  <script src="data.js"></script>
  <script>
    function $id(a){return document.getElementById(a);}
    function fmtAmt(n){return '₹'+(n? n.toFixed(2):'0.00');}
    function escape(s){return String(s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));}

    function render(){
      const st = DataStore.getState();
      const banks = DataStore.balancesPerBank();
      const area = $id('banksArea'); area.innerHTML='';

      banks.forEach(b=>{
        const div=document.createElement('div');
        div.style.cssText='display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px dashed rgba(255,255,255,0.03)';
        div.innerHTML=`
          <div>
            <strong>${escape(b.name)}</strong>
            <div style="font-size:12px;color:#9aa4b2">
              ${b.count} txns<br>
              Opening: ${fmtAmt(b.opening)}
            </div>
          </div>
          <div style="text-align:right">
            <div>${fmtAmt(b.balance)}</div>
            <div style="font-size:12px;color:#9aa4b2">
              inc ${fmtAmt(b.income)} • exp ${fmtAmt(b.expense)}
            </div>
          </div>
        `;
        area.appendChild(div);
      });

      ['transferFrom','transferTo'].forEach(id=>{
        const sel=$id(id); sel.innerHTML='';
        const o0=document.createElement('option');o0.value='';o0.textContent='Unassigned';sel.appendChild(o0);
        st.banks.forEach(b=>{
          const o=document.createElement('option');o.value=b.id;o.textContent=b.name;sel.appendChild(o);
        });
      });
    }

    $id('addBankBtn').onclick=()=>{
      const name=$id('newBankName').value.trim();
      const opening=parseFloat($id('newBankOpening').value)||0;
      if(!name){alert('Enter bank name');return;}
      DataStore.addBank(name,opening);
      $id('newBankName').value='';
      $id('newBankOpening').value='';
      render();
    };

    $id('doTransfer').onclick=()=>{
      const from=$id('transferFrom').value||null;
      const to=$id('transferTo').value||null;
      const amt=Number($id('transferAmt').value)||0;
      const date=$id('transferDate').value || new Date().toISOString().slice(0,10);
      const notes=$id('transferNotes').value.trim();
      if(!amt||amt<=0)return alert('Enter positive amount');
      if(from===to)return alert('Choose different banks');
      DataStore.transfer(from,to,amt,date,notes);
      alert('Transfer complete');
      render();
    };

    render();
  </script>
</body>
</html>
